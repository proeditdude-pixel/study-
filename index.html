<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Syllabus Pro | Asia Cloud Live</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        :root { 
            --bg: #000; --ui: #111; --text: #fff; --dim: #888; 
            --border: #222; --accent: #fff; --gold: #d4af37; --red: #ff4545;
        }

        /* Pro Theme Space Background */
        body.theme-space { 
            background: url('https://media2.giphy.com/media/v1.Y2lkPTZjMDliOTUycDJodTBqaDdiN3IyMHB6N3JmNm1rZmxycmd2ZWNmNXNicm9mZHYzYiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/sJvz8Qnfly3BOuotGx/giphy.gif') center/cover no-repeat fixed !important; 
        }

        body, html { margin: 0; padding: 0; background: var(--bg); color: var(--text); font-family: -apple-system, system-ui, sans-serif; height: 100vh; overflow: hidden; }

        /* --- CUSTOM GUI NOTIFICATIONS --- */
        #gui-notify { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 350px; background: var(--ui); border: 1px solid var(--border); padding: 15px; border-radius: 20px; z-index: 10001; transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; align-items: center; gap: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        #gui-notify.active { top: 20px; }

        /* --- OVERLAYS & MODALS --- */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); z-index: 9999; display: none; align-items: center; justify-content: center; padding: 25px; }
        .modal-gui { background: var(--ui); border: 1px solid var(--border); width: 100%; max-width: 320px; border-radius: 35px; padding: 35px; text-align: center; }
        .gui-input { width: 100%; background: #000; border: 1px solid var(--border); padding: 18px; border-radius: 16px; color: #fff; margin-bottom: 12px; outline: none; font-size: 16px; box-sizing: border-box; }

        /* --- PROFILE UI --- */
        .profile-header { position: relative; width: 100%; height: 180px; background: #111; border-bottom: 1px solid var(--border); }
        .banner-img { width: 100%; height: 100%; object-fit: cover; cursor: pointer; }
        .pfp-container { position: absolute; bottom: -40px; left: 25px; width: 85px; height: 85px; border-radius: 50%; border: 4px solid var(--bg); background: #222; overflow: hidden; cursor: pointer; }
        .pfp-img { width: 100%; height: 100%; object-fit: cover; }

        /* --- CARDS & BUTTONS --- */
        .custom-card { background: var(--ui); border: 1px solid var(--border); padding: 22px; border-radius: 28px; margin-bottom: 15px; position: relative; }
        .btn-gui { width: 100%; padding: 18px; border-radius: 18px; font-weight: 700; border: none; cursor: pointer; transition: 0.2s; }
        .btn-primary { background: var(--accent); color: #000; }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: #fff; }
        
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 95px; border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; background: rgba(0,0,0,0.95); z-index: 1000; }
        .nav-item { color: var(--dim); font-size: 11px; font-weight: 800; text-transform: uppercase; cursor: pointer; }
        .nav-item.active { color: var(--accent); }

        .screen { position: absolute; inset: 0; display: none; padding: 0 0 120px; overflow-y: auto; box-sizing: border-box; }
        .screen-active { display: block; }

        .status-dot { width: 8px; height: 8px; border-radius: 50%; background: #555; display: inline-block; margin-right: 5px; }
        .status-online { background: #00ff00; box-shadow: 0 0 10px #00ff00; }
    </style>
</head>
<body>

    <div id="gui-notify">
        <div style="width:12px; height:12px; border-radius:50%; background:var(--gold);"></div>
        <span id="notify-msg" style="font-size:13px; font-weight:700;">Connecting...</span>
    </div>

    <div id="modal-auth" class="overlay"><div class="modal-gui">
        <h2 id="atitle" style="margin-top:0">Cloud Account</h2>
        <input type="text" id="au" class="gui-input" placeholder="Username">
        <input type="password" id="ap" class="gui-input" placeholder="Password">
        <button class="btn-gui btn-primary" onclick="auth.confirm()">Sign In</button>
        <button class="btn-gui btn-outline" style="margin-top:10px" onclick="ui.close()">Cancel</button>
    </div></div>

    <div id="modal-create" class="overlay"><div class="modal-gui">
        <h2 style="margin-top:0">New Subject</h2>
        <input type="text" id="subject-input" class="gui-input" placeholder="Subject Name...">
        <button class="btn-gui btn-primary" onclick="core.saveTable()">Create</button>
        <button class="btn-gui btn-outline" style="margin-top:10px" onclick="ui.close()">Cancel</button>
    </div></div>

    <input type="file" id="input-banner" accept="image/*" style="display:none" onchange="profile.upload('banner', this)">
    <input type="file" id="input-pfp" accept="image/*" style="display:none" onchange="profile.upload('pfp', this)">

    <div id="view-home" class="screen screen-active" style="padding: 50px 25px;">
        <h1 style="font-size:38px; letter-spacing:-2px; margin-bottom:5px;">Workspace</h1>
        <div id="cloud-status" style="font-size:10px; color:var(--dim); margin-bottom:25px; font-weight:bold;">
            <span class="status-dot" id="s-dot"></span> <span id="s-text">OFFLINE MODE</span>
        </div>
        <div id="table-display" style="display:grid; grid-template-columns:1fr 1fr; gap:15px;"></div>
        <button class="btn-gui btn-primary" onclick="ui.openCreate()" style="margin-top:30px;">+ New Subject</button>
    </div>

    <div id="view-detail" class="screen" style="padding: 50px 25px;">
        <button class="btn-gui btn-outline" onclick="ui.show('home')" style="width:auto; padding:10px 20px;">← Back</button>
        <h1 id="det-title" style="margin:20px 0;">Subject</h1>
        <div id="task-list"></div>
        <button class="btn-gui btn-primary" onclick="core.addTask()">+ Add Goal</button>
        <button class="btn-gui btn-outline" style="margin-top:10px; border-color:var(--red); color:var(--red);" onclick="core.deleteTable()">Delete Subject</button>
    </div>

    <div id="view-profile" class="screen">
        <div class="profile-header">
            <img id="banner-img" class="banner-img" src="https://images.unsplash.com/photo-1614850523296-d8c1af93d400?w=1000" onclick="profile.trigger('banner')">
            <div class="pfp-container" onclick="profile.trigger('pfp')">
                <img id="pfp-img" class="pfp-img" src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
            </div>
        </div>
        <div style="padding:60px 25px">
            <h1 id="un-display" style="margin:0; font-size:32px;">Guest</h1>
            <div id="pro-badge" style="display:none; color:var(--gold); font-weight:900; font-size:11px; margin-top:5px; text-transform:uppercase;">Peak Member</div>
            
            <div id="guest-ui" style="margin-top:40px">
                <button class="btn-gui btn-primary" onclick="ui.openAuth('signup')">Create Cloud Account</button>
                <button class="btn-gui btn-outline" onclick="ui.openAuth('login')" style="margin-top:12px">Login to Cloud</button>
            </div>
            
            <div id="user-ui" style="display:none; margin-top:40px">
                <button class="btn-gui btn-primary" style="background:var(--gold); color:#000" onclick="core.buyPro()">Get Pro ✨</button>
                <button class="btn-gui btn-outline" style="margin-top:12px; color:var(--red); border-color:var(--red);" onclick="auth.logout()">Log Out</button>
            </div>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="ui.show('home', this)">Home</div>
        <div class="nav-item" onclick="ui.show('profile', this)">Profile</div>
    </nav>

<script>
    // --- YOUR SPECIFIC FIREBASE ASIA CONFIG ---
    const firebaseConfig = {
      apiKey: "AIzaSyC2ryrcM8eRTUIkBrVitQUWn2x5oTbbnmE",
      authDomain: "syllabuspro-4ec5c.firebaseapp.com",
      projectId: "syllabuspro-4ec5c",
      databaseURL: "https://syllabuspro-4ec5c-default-rtdb.asia-southeast1.firebasedatabase.app/",
      storageBucket: "syllabuspro-4ec5c.firebasestorage.app",
      messagingSenderId: "818806284256",
      appId: "1:818806284256:web:0ae37f2a46e3e812f09585"
    };

    firebase.initializeApp(firebaseConfig);
    const rtdb = firebase.database();

    const db = {
        user: localStorage.getItem('syl_user'),
        isPro: localStorage.getItem('syl_pro') === 'true',
        tables: JSON.parse(localStorage.getItem('syl_tabs')) || [],
        accounts: JSON.parse(localStorage.getItem('syl_accs')) || {},
        save() {
            localStorage.setItem('syl_tabs', JSON.stringify(this.tables));
            localStorage.setItem('syl_accs', JSON.stringify(this.accounts));
            localStorage.setItem('syl_user', this.user || "");
            localStorage.setItem('syl_pro', this.isPro);
            
            if(this.user) {
                rtdb.ref('users/' + this.user).set({ 
                    tables: this.tables, 
                    acc: this.accounts[this.user],
                    pro: this.isPro 
                }).then(() => ui.notify("Cloud Synced ✨"));
            }
        }
    };

    const ui = {
        notify(msg) { 
            const el = document.getElementById('gui-notify'); 
            document.getElementById('notify-msg').innerText = msg; 
            el.classList.add('active'); 
            setTimeout(()=>el.classList.remove('active'), 2500); 
        },
        show(id, el) { 
            document.querySelectorAll('.screen').forEach(s=>s.classList.remove('screen-active')); 
            document.getElementById('view-'+id).classList.add('screen-active'); 
            if(el) { document.querySelectorAll('.nav-item').forEach(t=>t.classList.remove('active')); el.classList.add('active'); }
        },
        openAuth(m) { auth.mode = m; document.getElementById('atitle').innerText = m === 'signup' ? 'New Cloud Account' : 'Welcome Back'; document.getElementById('modal-auth').style.display='flex'; },
        openCreate() { document.getElementById('modal-create').style.display='flex'; },
        close() { document.querySelectorAll('.overlay').forEach(o=>o.style.display='none'); },
        render() {
            document.getElementById('table-display').innerHTML = db.tables.map(t=>`
                <div class="custom-card" onclick="ui.openDetail(${t.id})">
                    <b style="font-size:18px">${t.name}</b><br>
                    <small style="color:var(--dim)">${t.tasks.length} Goals</small>
                </div>
            `).join('');
        },
        openDetail(id) {
            core.activeId = id; const t = db.tables.find(x=>x.id===id);
            document.getElementById('det-title').innerText = t.name;
            ui.renderTasks(); ui.show('detail');
        },
        renderTasks() {
            const t = db.tables.find(x=>x.id===core.activeId);
            document.getElementById('task-list').innerHTML = t.tasks.map((tk, i)=>`
                <div class="custom-card">
                    <input class="gui-input" value="${tk.sub}" placeholder="Subject" oninput="core.upd(${i},'sub',this.value)">
                    <input class="gui-input" value="${tk.task}" placeholder="Task" oninput="core.upd(${i},'task',this.value)">
                    <input type="date" class="gui-input" value="${tk.date}" oninput="core.upd(${i},'date',this.value)" style="background:#000">
                </div>
            `).join('');
        }
    };

    const auth = {
        mode: 'login',
        confirm() {
            const u = document.getElementById('au').value.trim();
            const p = document.getElementById('ap').value.trim();
            if(!u || !p) return ui.notify("Fill all fields");

            if(this.mode === 'signup') {
                db.accounts[u] = { pass: p, pfp: null, banner: null }; 
                db.user = u; db.save(); location.reload();
            } else {
                ui.notify("Checking Cloud...");
                rtdb.ref('users/' + u).once('value').then(s => {
                    const data = s.val();
                    if(data && data.acc.pass === p) {
                        db.user = u; db.tables = data.tables || []; db.accounts[u] = data.acc; db.isPro = data.pro || false;
                        db.save(); location.reload();
                    } else ui.notify("Invalid Cloud Login");
                });
            }
        },
        logout() { localStorage.clear(); location.reload(); }
    };

    const core = {
        activeId: null,
        saveTable() { const n = document.getElementById('subject-input').value; if(n){ db.tables.push({id:Date.now(), name:n, tasks:[]}); db.save(); ui.close(); ui.render(); }},
        deleteTable() { db.tables = db.tables.filter(t => t.id !== this.activeId); db.save(); ui.show('home'); ui.render(); },
        addTask() { db.tables.find(x=>x.id===this.activeId).tasks.push({sub:"",task:"",date:""}); db.save(); ui.renderTasks(); },
        upd(idx,k,v) { db.tables.find(x=>x.id===this.activeId).tasks[idx][k]=v; db.save(); },
        buyPro() { db.isPro = true; db.save(); ui.notify("Pro Unlocked!"); setTimeout(()=>location.reload(), 1000); }
    };

    const profile = {
        trigger(t) { if(db.user) document.getElementById('input-'+t).click(); else ui.notify("Login required"); },
        upload(t, i) {
            const f = i.files[0]; 
            if(f.type === 'image/gif' && !db.isPro) return ui.notify("Pro required for GIFs");
            const r = new FileReader();
            r.onload = (e) => { 
                db.accounts[db.user][t] = e.target.result; 
                db.save(); 
                setTimeout(()=>location.reload(), 500); 
            };
            r.readAsDataURL(f);
        }
    };

    // Initial Login Check
    if(db.user) {
        document.getElementById('un-display').innerText = db.user;
        document.getElementById('s-dot').classList.add('status-online');
        document.getElementById('s-text').innerText = "CLOUD ACTIVE: " + db.user.toUpperCase();
        document.getElementById('guest-ui').style.display='none'; 
        document.getElementById('user-ui').style.display='block';
        const cur = db.accounts[db.user];
        if(cur && cur.pfp) document.getElementById('pfp-img').src = cur.pfp;
        if(cur && cur.banner) document.getElementById('banner-img').src = cur.banner;
    }
    if(db.isPro) {
        document.getElementById('pro-badge').style.display = 'block';
        document.body.classList.add('theme-space');
    }
    ui.render();
</script>
</body>
</html>
